@attribute [Route(Routes.Ships)]
@inherits FluxorComponent

<MudStack Class="pa-4">
    <MudStack Row AlignItems="AlignItems.End">
        <MudText Typo="Typo.h3">@($"Ships for {Identifier}")</MudText>
        <MudSpacer />

    </MudStack>
    @if (ShipState.Value.IsLoading)
    {
        <MudProgressCircular Indeterminate
                             Class="ma-auto"
                             Size="Size.Large" />
    }
    else if (ShipState.Value.Ships.Any())
    {
        <MudTable Items="@ShipState.Value.Ships.OrderBy(_ => _.ShipSymbol)" Hover>
            <HeaderContent>
                <MudTh>Symbol</MudTh>
                <MudTh>Role</MudTh>
                <MudTh>System</MudTh>
                <MudTh>Waypoint</MudTh>
                <MudTh>Nav status</MudTh>
                <MudTh>Flight mode</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Symbol">
                    <MudLink Href="@RouteHelpers.Ship(Identifier, context.ShipSymbol)" Typo="Typo.body1">@context.ShipSymbol</MudLink>
                </MudTd>
                <MudTd DataLabel="Role">
                    <MudText Typo="Typo.body1">@context.Role</MudText>
                </MudTd>
                 <MudTd DataLabel="System">
                    <MudText Typo="Typo.body1">@ShipState.Value.GetShipNav(context.ShipSymbol)?.SystemSymbol</MudText>
                </MudTd>
                <MudTd DataLabel="Waypoint">
                    @if (ShipState.Value.GetShipNav(context.ShipSymbol) is { } shipNav)
                    {
                        <MudLink Href="@RouteHelpers.Waypoint(Identifier, WaypointsHelpers.GetSystemFromWaypoint(shipNav.WaypointSymbol), shipNav.WaypointSymbol)" Typo="Typo.body1">@shipNav.WaypointSymbol</MudLink>
                    }
                </MudTd>
                <MudTd DataLabel="Nav status">
                    <MudText Typo="Typo.body1">@ShipState.Value.GetShipNav(context.ShipSymbol)?.Status</MudText>
                </MudTd>
                <MudTd DataLabel="Flight mode">
                    <MudText Typo="Typo.body1">@ShipState.Value.GetShipNav(context.ShipSymbol)?.FlightMode</MudText>
                </MudTd>
            </RowTemplate>
        </MudTable>
    }
    else
    {
        <MudText Typo="Typo.body1">No ships</MudText>
    }
</MudStack>